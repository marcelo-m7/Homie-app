services:
  homie:
    image: ghcr.io/brramble/homie:latest
    container_name: homie
    restart: unless-stopped
    ports:
      - "5000:5000"
    volumes:
      - ./data:/app/data
    environment:
      # Flask Configuration
      - FLASK_ENV=production
      - PYTHONUNBUFFERED=1
      
      # Security
      - FLASK_SECRET_KEY=your-very-secure-secret-key-here-change-this
      
      # OIDC Authentication (replace with your provider details)
      - OIDC_BASE_URL=https://your-oidc-provider.com
      - OIDC_CLIENT_ID=your-client-id
      - OIDC_CLIENT_SECRET=your-client-secret
      - OIDC_REDIRECT_URI=http://localhost:5000/auth/callback
      
      # Manual OIDC endpoints (uncomment if auto-discovery fails)
      # For Authentik (replace 'homie' with your application slug):
      # - OIDC_ISSUER=https://auth.example.com/application/o/homie/
      # - OIDC_AUTHORIZATION_ENDPOINT=https://auth.example.com/application/o/authorize/
      # - OIDC_TOKEN_ENDPOINT=https://auth.example.com/application/o/token/
      # - OIDC_USERINFO_ENDPOINT=https://auth.example.com/application/o/userinfo/
      # - OIDC_END_SESSION_ENDPOINT=https://auth.example.com/application/o/homie/end-session/
      
      # For other providers:
      # - OIDC_AUTHORIZATION_ENDPOINT=https://your-provider.com/auth
      # - OIDC_TOKEN_ENDPOINT=https://your-provider.com/token
      # - OIDC_USERINFO_ENDPOINT=https://your-provider.com/userinfo
      
      # Access Control (comma-separated)
      - ALLOWED_EMAILS=user1@example.com,user2@example.com
      - ALLOWED_GROUPS=family,admins
      - ADMIN_EMAILS=admin@example.com